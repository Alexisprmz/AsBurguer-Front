<div class="user-form-dialog">
  
  <div class="dialog-header">
    <div class="header-text">
      <h2>{{ id ? 'Editar Usuario' : 'Nuevo Usuario' }}</h2>
      <p>{{ id ? 'Modifica los datos del usuario' : 'Completa la información del usuario' }}</p>
    </div>
  </div>

  <form [formGroup]="formulario" (ngSubmit)="save()" class="user-form">
    
    <div class="form-field">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nombre</mat-label>
        <span matPrefix class="field-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
            <circle cx="12" cy="7" r="4"/>
          </svg>
        </span>
        <input type="text" matInput formControlName="name" placeholder="Nombre completo">
        <mat-error>El nombre es requerido</mat-error>
      </mat-form-field>
    </div>
    <div class="form-field">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Contraseña</mat-label>
        <span matPrefix class="field-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
            <path d="M7 11V7a5 5 0 0110 0v4"/>
          </svg>
        </span>
        <input type="password" matInput formControlName="password" placeholder="Contraseña">
        <mat-error>La contraseña es requerida</mat-error>
      </mat-form-field>
    </div>

    <div class="form-field">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Teléfono</mat-label>
        <span matPrefix class="field-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
          </svg>
        </span>
        <input type="text" matInput formControlName="phone" placeholder="Número de teléfono">
      </mat-form-field>
    </div>

    <div class="form-field">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Rol</mat-label>
        <span matPrefix class="field-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M23 21v-2a4 4 0 00-3-3.87m-4-12a4 4 0 010 7.75"/>
          </svg>
        </span>
        <mat-select formControlName="rol" placeholder="Selecciona un rol">
          @for (rol of roles; track $index) {
            <mat-option [value]="rol.value">{{rol.name}}</mat-option>
          }
        </mat-select>
        <mat-error>El rol es requerido</mat-error>
      </mat-form-field>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn-primary" [disabled]="formulario.invalid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/>
          <polyline points="17,21 17,13 7,13 7,21"/>
          <polyline points="7,3 7,8 15,8"/>
        </svg>
        Guardar
      </button>
      
      @if (id) {
        <button type="button" class="btn-delete" (click)="deleteUser()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
            <line x1="10" y1="11" x2="10" y2="17"/>
            <line x1="14" y1="11" x2="14" y2="17"/>
          </svg>
          Eliminar
        </button>
      }
    </div>
  </form>
</div>