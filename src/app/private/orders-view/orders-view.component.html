<div class="orders-page">
  <div class="page-header">
    <h1>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="18" height="18" rx="2"/>
        <path d="M9 3v18M3 9h18M3 15h18M15 3v18"/>
      </svg>
      Gestión de Órdenes
    </h1>
  </div>

  <mat-tab-group fitInkBarToContent class="orders-tabs">
    @for (eachStatus of status; track $index) {
      <mat-tab label="{{eachStatus.name}}">
        <div class="tab-content">
          <section class="table-wrapper">
            <table mat-table [dataSource]="filterByStatus(eachStatus.value)" class="orders-table">

              <ng-container matColumnDef="client">
                <th mat-header-cell *matHeaderCellDef>Cliente</th>
                <td mat-cell *matCellDef="let element">
                  <div class="client-cell">
                    <span class="client-name">{{element.client}}</span>
                  </div>
                </td>
              </ng-container>

              <ng-container matColumnDef="total">
                <th mat-header-cell *matHeaderCellDef>Total</th>
                <td mat-cell *matCellDef="let element">
                  <div class="total-cell">
                    <span class="total-amount">{{element.total}}</span>
                  </div>
                </td>
              </ng-container>

              <ng-container matColumnDef="comments">
                <th mat-header-cell *matHeaderCellDef>Comentarios</th>
                <td mat-cell *matCellDef="let element">
                  <div class="comments-cell">
                    @if (element.comments) {
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/>
                      </svg>
                      <span>{{element.comments}}</span>
                    } @else {
                      <span class="no-comments">Sin comentarios</span>
                    }
                  </div>
                </td>
              </ng-container>

              <ng-container matColumnDef="function">
                <th mat-header-cell *matHeaderCellDef>Funciones</th>
                <td mat-cell *matCellDef="let element">
                  <div class="actions-cell">
                    <button class="btn-view" (click)="openOrderDetailDialog(element)">
                      Ver Detalles
                    </button>
                    @if (eachStatus.value == 0) {
                      <button class="btn-cancel" (click)="openCancelDialog(element)">
                        Cancelar
                      </button>
                    }
                    @if (eachStatus.value == 2) {
                      <button class="btn-complete" (click)="openConfirmDialog(element)">
                        Completar
                      </button>
                    }
                  </div>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
          </section>
        </div>
      </mat-tab>
    }
  </mat-tab-group>
</div>
